# Домашнее задание № 1

## 1. Тема и целевая аудитория

### 1.1. Тема 
Twitch [[1](https://ru.wikipedia.org/wiki/Twitch)] - видеостриминговый сервис, специализирующийся на тематике компьютерных игр, в том числе трансляциях геймплея и киберспортивных турниров. Видео на платформе Twitch можно просматривать как в реальном времени, так и по запросу. Twitch принадлежит Twitch Interactive — дочерней компании Amazon.

### 1.2 . Целевая аудитория 
В августе количество поситителей превысило отметку в 1.2 миллиарда посетителей в месяц, это примерно 40 миллионов посетителей в день. [[2](https://www.similarweb.com/ru/website/twitch.tv/#traffic)]
Целевая аудитория согласно [[тык](https://www.similarweb.com/ru/website/twitch.tv/#geography)] по количеству поситителей:
1. Соединённые штаты - 20.48%
2. Германия - 6.54%
3. Республика Корея - 5.09%
4. Россия - 4.70%
5. Франция - 4.27%

### 1.3. MVP
* Просмотр онлайн трансляций
* Чат закреплённый к трансляции
* Платная и бесплатная подписка на канал
* Авторизация пользователей

## 2. Расчёт нагрузки

### 2.1. Продуктовые метрики 
* Месячная аудитория - 1.2 млрд [[2](https://www.similarweb.com/ru/website/twitch.tv/#traffic)]
* Суточная аудитория - 40 млн [[2](https://www.similarweb.com/ru/website/twitch.tv/#traffic)]
* Среднее время, проведенное на веб-сайте - 00:08:51 [[2](https://www.similarweb.com/ru/website/twitch.tv/#traffic)]
* Среднее количество страниц за визит - 4.48 [[2](https://www.similarweb.com/ru/website/twitch.tv/#traffic)]

Согласно [статистике просмотров](https://streamscharts.com/overview) за прошлый месяц среднее количество просмотров в день было около 2.6 миллионов зрителей.

Для того чтобы понять сколько сообщений в чат отправляют пользователи, обратимся к ресурсу, на котором указано [среднее количество сообщений в секунду](https://stats.streamelements.com/). На момент просмотра статистики среднее значение было 720 сообщений в секунду => 720 * 60 * 60 * 24 = 62.2 млн в день.

Общей информации о количестве всех подписок на все каналы в открытом доступе нет. Поэтому я проанализирвал [среднее количество просмотров](https://streamscharts.com/subscribers) на популярных каналах и среднее количество подписок на их каналы в месяц. Исходя их этого можно предположить, что примерно 6.34% от живых зрителей подписываются на канал => 0.0634 * 2.6 млн в день = 0.165 млн в день.

Говорить о количестве запросов на авторизацию - тяжело, поэтому предположим, что 20% всех ежедневных пользователей смотрящих трансялции проходит запросы авторизации => 0.2 * 2.6 млн = 0.52 млнв день. 

**Среднее количество действий пользователей**
Тип запроса                | Среднее количество (Измеряем в млн/день)
-------------------------- | -----------------------------
Просмотр онлайн трансляции |  2.6
Отправка сообщения в чат   |  62.2 
Подписка на стримера       |  0.165
Авторизация                |  0.52

### 2.2. Технические метрики
#### 2.2.1. Сетевой трафик
##### 2.2.1.1. Входящий трафик
Ежедневно на платформе  [происходит стрмминг](https://twitchtracker.com/statistics/stream-time) 2 083 003 часов.
На twitch, можно выбрать качество просмотра трансялции, возьмём среднее из [источника](https://help.twitch.tv/s/article/broadcast-guidelines?language=ru): ```720p 60fps = 4500 кбит/с```
```
2 083 003 * 60 * 60 с * 4500 кбит/с =  3750000 Гб в сутки 
```
Из этого следует, что 3750000 - входящий трафик в сутки, который тратится на создание трансляций.

Для того чтобы расчитать нагрузку чата, возьмём вес одного символа 16 бит, а средний размер сообщения: 3 символов. Тогда 48 бит - вес в среднем одного сообщения. ``` 48 * 62 200 000 = 0,37 Гб в сутки```

Сделаем ещё одно допущение: пусть на один запрос авторизации будет весом 1 кб памяти. Тогда в сутки будет обрабатываться 0.52 гб. 

Информацие о подписках на стримера можно пренебречь, т.к. эти данные существенно меньше, чем входящий трафик на другие категории.

##### 2.2.1.2. Исходящий трафик
Средняя продолжительность нахождения на платформе равна 00:08:51 (531 секунда) в сутки как уже говорилось выше. Количество посетителей сайта 40 млн в день. Далеко не каждый из этих пользовтаелей проводит своё время за просмотром трансляций, будем считать, что процент смотрящих трансляции людей равен 80% от 40 млн.
```
531 c * 4500 кбит/с * 40 000 000 млн/сутки  * 0.8 = 8 750 000 Гб
```
Выходит, что 8 750 000 Гб - исходящий трафик в сутки

В чат еждневно пишут 62.2 млн сообщений в сутки. Так как для каждого пользователя необходимо сохранять историю чата, для его просмотра, то при грубой оценке для всех 80% от 40 млн ежедневных посещений необходимо отдавать 0,37 Гб входящего трафика сообщений из чата.
```
0,37 * 40 000 000 млн/сутки  * 0.8 = 11 800 000 Гб в сутки
```
Выходит, что : исходящий трафик для чата приблизительно равен 11 800 000 Гб в сутки
#### 2.2.2. RPS
Тип запроса                | RPS
-------------------------- | -----------------------------
Просмотр онлайн трансляции |  30
Отправка сообщения в чат   |  30 
Подписка на стримера       |  2
Авторизация                |  6
## 3. Источники
1. https://ru.wikipedia.org/wiki/Twitch
2. https://www.similarweb.com/ru/website/twitch.tv/#traffic
3. https://www.similarweb.com/ru/website/twitch.tv/#geography
4. https://streamscharts.com/overview
5. https://stats.streamelements.com/
6. https://streamscharts.com/subscribers
7. https://twitchtracker.com/statistics/stream-time 
8. https://help.twitch.tv/s/article/broadcast-guidelines?language=ru
